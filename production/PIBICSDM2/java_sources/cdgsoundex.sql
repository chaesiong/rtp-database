CREATE JAVA SOURCE NAMED "PIBICSDM2"."CDGSOUNDEX" AS 
 public class CDGSoundex {    String FSsoundex = "";    String FSNameTmp = "";    String FScode = "";    int FSp_len;    String FSp_chk = "";    String FSword[] = new String[25];    int size;    String FSsara[] = new String[25];    int i;    String n = "";    private void check1() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        if (this.FSp_len > 3) {            for (this.size = 0; this.size < this.FSp_len; this.size++) {                this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);                this.cutChk1();            }        }        this.letVal();    }    private void check2() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        for (this.size = 0; this.size < this.FSp_len; this.size++) {            this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);            this.cutChk2();        }        this.letVal();    }    private void check3() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        for (this.size = 0; this.size < this.FSp_len; this.size++) {            this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);            this.cutChk3();        }        this.letVal();    }    private void chgFirst() {        if (this.FSword[this.size].equals("ค") || this.FSword[this.size].equals("ฆ")) {            this.FSword[this.size] = "ข";        } else if (this.FSword[this.size].equals("ฌ") || this.FSword[this.size].equals("ฉ")) {            this.FSword[this.size] = "ช";        } else if (this.FSword[this.size].equals("ศ") || this.FSword[this.size].equals("ส") || this.FSword[this.size].equals("ษ")) {            this.FSword[this.size] = "ซ";        } else if (this.FSword[this.size].equals("ฎ")) {            this.FSword[this.size] = "ด";        } else if (this.FSword[this.size].equals("ฏ")) {            this.FSword[this.size] = "ต";        } else if (this.FSword[this.size].equals("ธ") || this.FSword[this.size].equals("ฑ") || this.FSword[this.size].equals("ฒ") || this.FSword[this.size].equals("ถ") || this.FSword[this.size].equals("ฐ")) {            this.FSword[this.size] = "ท";        } else if (this.FSword[this.size].equals("ณ")) {            this.FSword[this.size] = "น";        } else if (this.FSword[this.size].equals("ภ") || this.FSword[this.size].equals("ผ")) {            this.FSword[this.size] = "พ";        } else if (this.FSword[this.size].equals("ฝ")) {            this.FSword[this.size] = "ฟ";        } else if (this.FSword[this.size].equals("ญ")) {            this.FSword[this.size] = "ย";        } else if (this.FSword[this.size].equals("ล") || this.FSword[this.size].equals("ฬ") || this.FSword[this.size].equals("ฤ")) {            this.FSword[this.size] = "ร";        }    }    private void chgNext() {        if (this.FSword[this.size].equals("ข") || this.FSword[this.size].equals("ค") || this.FSword[this.size].equals("ฆ")) {            this.FSword[this.size] = "ก";        } else if (this.FSword[this.size].equals("จ") || this.FSword[this.size].equals("ฉ") || this.FSword[this.size].equals("ช") || this.FSword[this.size].equals("ซ") || this.FSword[this.size].equals("ฌ") || this.FSword[this.size].equals("ฎ") || this.FSword[this.size].equals("ฏ") || this.FSword[this.size].equals("ฐ") || this.FSword[this.size].equals("ฑ") || this.FSword[this.size].equals("ฒ") || this.FSword[this.size].equals("ต") || this.FSword[this.size].equals("ถ")                || this.FSword[this.size].equals("ท") || this.FSword[this.size].equals("ธ") || this.FSword[this.size].equals("ศ") || this.FSword[this.size].equals("ษ") || this.FSword[this.size].equals("ส")) {            this.FSword[this.size] = "ด";        } else if (this.FSword[this.size].equals("ญ") || this.FSword[this.size].equals("ณ") || this.FSword[this.size].equals("ร") || this.FSword[this.size].equals("ล") || this.FSword[this.size].equals("ฬ") || this.FSword[this.size].equals("ฤ")) {            this.FSword[this.size] = "น";        } else if (this.FSword[this.size].equals("ป") || this.FSword[this.size].equals("พ") || this.FSword[this.size].equals("ฟ") || this.FSword[this.size].equals("ภ") || this.FSword[this.size].equals("ผ") || this.FSword[this.size].equals("ฝ")) {            this.FSword[this.size] = "บ";        } else if (this.FSword[this.size].equals("ำ")) {            this.FSword[this.size] = "ม";        } else if (this.FSword[this.size].equals("ว")) {            this.FSword[this.size] = "ย";        }    }    private void chgSaraI() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        for (this.size = 0; this.size < this.FSp_len; this.size++) {            this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);            this.cutChgSaraI();        }        this.letVal();    }    private void chgSaraU() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        if (this.FSp_len > 3) {            for (this.size = 0; this.size < this.FSp_len; this.size++) {                this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);                this.cutChgSaraU();            }        }        this.letVal();    }    private void chkCodeE(String n) {        this.FSsoundex = n.trim().substring(0, 1);        for (this.size = 1; this.size < n.trim().length(); this.size++) {            this.FSword[this.size] = n.substring(this.size, this.size + 1);            this.letCode();            this.chkDup();        }        this.chkLen();    }    private void chkCodeT(String n) {        this.chkKaran(n);// ' ตัดการันต์        this.chkRoRo(); // ' เปลี่ยนรูปตัว รร        this.check3();// ' เช็ค -อน และ -ร (-อน = -ร) และ ศรี ( ศรี = ศี)        this.check1();// ' ตรวจคำควบกล้ำ        this.check2();// 'อักษรนำเสียงสนิท        this.chgSaraI();// 'เปลี่ยน ไ-ย,-ัย เป็น ไ        this.chgSaraU();// 'จัดรูปสระอุ        this.gupSara();// 'จัดกลุ่มอักษร ตัดสระ ะ,ิ,ั และวรรณยุกต์ ่,้,๊,๋        this.moveSara();// 'ย้ายสระ เ,แ,ไ,โ,มไ,ใ ไปไว้ข้างหลัง    }    private void chkDup() {        if (this.size > 0) {            if ((this.FSword[this.size] == this.FSword[this.size - 1]) || (" ".equals(this.FSword[this.size]))) {                this.FSword[this.size] = ""; // FSword(size) = ""            }        } else {            this.FSword[this.size] = ""; // FSword(size) = ""        }        this.FSsoundex = this.RTrim(this.FSsoundex) + this.FSword[this.size];    }    private void chkKaran(String n) {        this.FSNameTmp = n.trim();        this.FSp_len = this.FSNameTmp.trim().length();        for (this.size = 0; this.size < this.FSp_len; this.size++) {            if (this.FSp_len > 3) {                this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);                if (this.FSword[this.size].equals("์")) {                    this.FSp_chk = this.FSword[this.size - 2] + "" + this.FSword[this.size - 1];                    this.FSword[this.size] = "";// ''                    if ((this.RTrim(this.FSp_chk).equals("ทร")) || (this.RTrim(this.FSp_chk).equals("ตว")) || (this.RTrim(this.FSp_chk).equals("ตร")) || (this.RTrim(this.FSp_chk).equals("จน")) || (this.RTrim(this.FSp_chk).equals("ทน")) || (this.RTrim(this.FSp_chk).equals("วน")) || this.FSword[this.size - 1].equals("ุ") || this.FSword[this.size - 1].equals("ิ")) {                        this.FSword[this.size - 2] = ""; // ''                    }                    this.FSword[this.size - 1] = "";                }            } else {                this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);            }        }        this.letVal();    }    private void chkLen() {        this.size = this.FSsoundex.trim().length();        if (this.size < 4) {            while (this.size < 4) {                this.FSword[this.size] = "0";                this.size = this.size + 1;                this.FSsoundex = this.RTrim(this.FSsoundex) + this.FSword[this.size - 1];            }        } else {            while (this.size > 4) {                this.FSword[this.size - 1] = "";                this.size = this.size - 1;                this.FSsoundex = this.FSsoundex.substring(0, 4) + this.FSword[this.size - 1];            }        }    }    private void chkRoRo() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        if (this.FSp_len >= 3) {            for (this.size = 0; this.size < this.FSp_len; this.size++) {                this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);                this.cutRoRo();            }        }        this.letVal();    }    private void cutChgSaraI() {        if (this.FSword[this.size].equals("ใ")) {            this.FSword[this.size] = "ไ";        } else {            if (this.size > 1) {                if ((this.FSword[this.size - 1].equals("ั")) && (this.FSword[this.size].equals("ย"))) {                    this.FSword[this.size - 1] = this.FSword[this.size - 2];                    this.FSword[this.size - 2] = "ไ";                    this.FSword[this.size] = ""; // ''                } else if ((this.FSword[this.size - 2].equals("ไ")) && (this.FSword[this.size].equals("ย"))) {                    this.FSword[this.size] = ""; // ''                }            }        }    }    private void cutChgSaraU() {        if (this.size > 2) {            if (this.FSword[this.size].equals("ุ")) {                if (this.FSword[this.size - 1].equals("ต")) {                    this.FSword[this.size] = "";// ''                }            }        }    }    private void cutChk1() {        if (this.size == 0) {            this.FSp_chk = this.FSword[this.size];        } else {            this.FSp_chk = this.FSword[this.size - 1] + this.FSword[this.size];        }        String strChk = this.RTrim(this.FSp_chk);        if ((this.size > 0) && (this.size != this.FSp_len - 1)) {            if (strChk.equals("กร") || strChk.equals("กร") || strChk.equals("กล") || strChk.equals("กว") || strChk.equals("ขร") || strChk.equals("ขว") || strChk.equals("คร") || strChk.equals("คล") || strChk.equals("ดร") || strChk.equals("ตร") || strChk.equals("ทร") || strChk.equals("ปร") || strChk.equals("ปล") || strChk.equals("พร") || strChk.equals("พล") || strChk.equals("ผล")) {                this.FSword[this.size] = "";                if (strChk.equals("ทร")) {                    this.FSword[this.size - 1] = "ซ";                }            }        }    }    private void cutChk2() {        if (this.size == 0) {            this.FSp_chk = this.FSword[this.size];        } else {            if (this.size > 0) {                this.FSp_chk = this.FSword[this.size - 1] + this.FSword[this.size];            } else {                this.FSp_chk = this.FSword[this.size];            }        }        String strChk = this.RTrim(this.FSp_chk);        if (this.size >= 1) {            if (strChk.equals("หง") || strChk.equals("หญ") || strChk.equals("หน") || strChk.equals("หม") || strChk.equals("อย") || strChk.equals("หย") || strChk.equals("หร") || strChk.equals("หล") || strChk.equals("หว")) {                this.FSword[this.size - 1] = "";            }        }    }    private void cutChk3() {        if (this.size > 2) {            if (this.size == this.FSp_len) {                this.FSp_chk = this.FSword[this.size - 1] + this.FSword[this.size];                if (this.FSp_chk.trim().equals("อน")) {                    this.FSword[this.size - 1] = "ร";                    this.FSword[this.size] = "";                } else if (this.size > 3) {                    this.FSp_chk = this.FSword[this.size - 2] + this.FSword[this.size - 1];                    if (((this.FSp_chk.trim().equals("อน")) && (!(this.FSword[this.size - 3].matches("เแโไใ")))) || (!(this.FSword[this.size].matches("ำะาิีึืุู่้๊๋็ั")))) {                        this.FSword[this.size - 2] = "ร";                        this.FSword[this.size - 1] = "";                    }                }            }            // 'Chek การอ่าน ศรี            if ((this.FSword[this.size - 2].equals("ศ")) && (this.FSword[this.size - 1].equals("ร") && (this.FSword[this.size].equals("ี")))) {                this.FSword[this.size - 1] = "ี";                this.FSword[this.size] = "";            }        }    }    private void cutMoveSara() {        this.FSsara = new String[this.size + 1];        this.initializesStringArray(this.FSsara);        if (this.FSword[this.size].equals("เ") || this.FSword[this.size].equals("แ") || this.FSword[this.size].equals("โ") || this.FSword[this.size].equals("ไ")) {            this.FSsara[this.size] = this.FSword[this.size];            this.FSword[this.size] = "";        }        this.FScode = this.FScode.trim() + this.FSsara[this.size];    }    private void cutRoRo() {        if ((this.size < (this.FSp_len - 1)) && (this.size > 3)) {            this.FSp_chk = this.FSword[this.size - 3] + this.FSword[this.size - 2];            if (this.RTrim(this.FSp_chk).equals("รร")) {                if ((!this.FSword[this.size - 1].equals("ะ")) || (!this.FSword[this.size - 1].equals("า")) || (!this.FSword[this.size - 1].equals("ิ")) || (!this.FSword[this.size - 1].equals("ี")) || (!this.FSword[this.size - 1].equals("ุ")) || (!this.FSword[this.size - 1].equals("ู"))) {                    this.FSword[this.size - 3] = "ั";                    this.FSword[this.size - 2] = "น";                    if (this.FSword[this.size - 1].equals("ค") || this.FSword[this.size - 1].equals("ณ") || this.FSword[this.size - 1].equals("ด") || this.FSword[this.size - 1].equals("ถ") || this.FSword[this.size - 1].equals("พ") || this.FSword[this.size - 1].equals("ม") || this.FSword[this.size - 1].equals("ษ")) {                        if ((!this.FSword[this.size].equals("ะ")) || (!this.FSword[this.size].equals("า")) || (!this.FSword[this.size].equals("ิ")) || (!this.FSword[this.size].equals("ี")) || (!this.FSword[this.size].equals("ุ")) || (!this.FSword[this.size].equals("ู"))) {                            this.FSword[this.size - 2] = "";                        }                    }                }            }        } else {            if (this.size == this.FSp_len - 1) {                this.FSp_chk = this.FSword[this.size - 1] + this.FSword[this.size];                if (this.RTrim(this.FSp_chk).equals("รร")) {                    this.FSword[this.size - 1] = "ั";                    this.FSword[this.size] = "น";                } else {                    this.FSp_chk = this.FSword[this.size - 2] + this.FSword[this.size - 1];                    if (this.RTrim(this.FSp_chk).equals("รร")) {                        this.FSword[this.size - 2] = "ั";                        this.FSword[this.size - 1] = "น";                        if (this.FSword[this.size].equals("ค") || this.FSword[this.size].equals("ณ") || this.FSword[this.size].equals("ด") || this.FSword[this.size].equals("ถ") || this.FSword[this.size].equals("พ") || this.FSword[this.size].equals("ม") || this.FSword[this.size].equals("ษ")) {                            this.FSword[this.size - 1] = "";                        }                    }                }            }        }    }    private String RTrim(String s) {        int len = s.length();        if (len > 0) {            while (s.charAt(len - 1) == ' ') {                s = s.substring(0, len - 1);                len--;            }        }        return (s);    }    private void cutSara() {        if (this.FSword[this.size].equals("่") || this.FSword[this.size].equals("้") || this.FSword[this.size].equals("๊") || this.FSword[this.size].equals("๋") || this.FSword[this.size].equals("็") || this.FSword[this.size].equals("ะ") || this.FSword[this.size].equals("ั")) {            this.FSword[this.size] = "";        }    }    private void gupSara() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        for (this.size = 0; this.size < this.FSp_len; this.size++) {            this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);            switch (this.size) {                case 0:                    if ((!this.FSword[0].equals("เ")) || (!this.FSword[0].equals("แ")) || (!this.FSword[0].equals("โ")) || (!this.FSword[0].equals("ไ")) || (!this.FSword[0].equals("ใ"))) {                        this.chgFirst();                    }                    break;                case 1:                    if (this.FSword[0].equals("เ") || this.FSword[0].equals("แ") || this.FSword[0].equals("โ") || this.FSword[0].equals("ไ") || this.FSword[0].equals("ใ")) {                        this.chgFirst();                    } else {                        this.chgNext();                    }                    break;                default:                    this.chgNext();            }            this.cutSara();        }        this.letVal();    }    private void letCode() {        if (this.FSword[this.size].equals("A") || this.FSword[this.size].equals("a") || this.FSword[this.size].equals("E") || this.FSword[this.size].equals("e") || this.FSword[this.size].equals("H") || this.FSword[this.size].equals("h") || this.FSword[this.size].equals("I") || this.FSword[this.size].equals("i") || this.FSword[this.size].equals("O") || this.FSword[this.size].equals("o") || this.FSword[this.size].equals("U") || this.FSword[this.size].equals("u")                || this.FSword[this.size].equals("W") || this.FSword[this.size].equals("w") || this.FSword[this.size].equals("Y") || this.FSword[this.size].equals("y")) {            this.FSword[this.size] = "";        } else if (this.FSword[this.size].equals("B") || this.FSword[this.size].equals("b") || this.FSword[this.size].equals("F") || this.FSword[this.size].equals("f") || this.FSword[this.size].equals("P") || this.FSword[this.size].equals("p") || this.FSword[this.size].equals("V") || this.FSword[this.size].equals("v")) {            this.FSword[this.size] = "1";        } else if (this.FSword[this.size].equals("C") || this.FSword[this.size].equals("c") || this.FSword[this.size].equals("G") || this.FSword[this.size].equals("g") || this.FSword[this.size].equals("J") || this.FSword[this.size].equals("j") || this.FSword[this.size].equals("K") || this.FSword[this.size].equals("k") || this.FSword[this.size].equals("Q") || this.FSword[this.size].equals("q") || this.FSword[this.size].equals("S") || this.FSword[this.size].equals("s")                || this.FSword[this.size].equals("X") || this.FSword[this.size].equals("x") || this.FSword[this.size].equals("Z") || this.FSword[this.size].equals("z")) {            this.FSword[this.size] = "2";        } else if (this.FSword[this.size].equals("D") || this.FSword[this.size].equals("d") || this.FSword[this.size].equals("T") || this.FSword[this.size].equals("t")) {            this.FSword[this.size] = "3";        } else if (this.FSword[this.size].equals("L") || this.FSword[this.size].equals("l")) {            this.FSword[this.size] = "4";        } else if (this.FSword[this.size].equals("M") || this.FSword[this.size].equals("m") || this.FSword[this.size].equals("N") || this.FSword[this.size].equals("n")) {            this.FSword[this.size] = "5";        } else if (this.FSword[this.size].equals("R") || this.FSword[this.size].equals("r")) {            this.FSword[this.size] = "6";        }    }    private void letVal() {        for (this.i = 0; this.i < this.FSp_len; this.i++) {            this.FSsoundex = this.FSsoundex.trim() + this.FSword[this.i];        }    }    private void moveSara() {        this.FSNameTmp = this.FSsoundex.trim();        this.FSsoundex = "";        this.FSp_len = this.FSNameTmp.trim().length();        for (this.size = 0; this.size < this.FSp_len; this.size++) {            this.FSword[this.size] = this.FSNameTmp.substring(this.size, this.size + 1);            this.cutMoveSara();        }        this.letVal();        this.saraBack();    }    private void saraBack() {        this.FSp_len = this.FScode.trim().length();        for (this.size = 0; this.size < this.FSp_len; this.size++) {            this.FSsara[this.size] = this.FScode.substring(this.size, this.size + 1);            this.FSsoundex = this.FSsoundex + this.FSsara[this.size];        }        this.FScode = "";    }    private void initializesStringArray(String[] s) {        for (int i = 0; i < s.length; i++) {            s[i] = "";        }    }    /**     * แปลงเป็นคำพ้องเสียง     *     * @param n String คำที่ต้องการแปลงเป็นคำพ้องเสียง     * @return String     */    public String soundexF(String n) {          try{                  if ((n != null) && !n.equals("null")) {                        if (n.length() > 0) {                              String str = n.trim().substring(0, 1);                              if (n.trim().length() > 25) {                                    this.size = n.trim().length();                              } else {                                    this.size = 25;                              }                              this.FSword = new String[this.size];                              this.initializesStringArray(this.FSword);                              this.FSsoundex = "";                              if ((str.compareTo("A") >= 0) && (str.compareTo("z") <= 0)) {                                    this.chkCodeE(n);                              } else {                                    this.chkCodeT(n);                              }                        } else {                              this.FSsoundex = "";                        }                  }                  return this.FSsoundex;            }catch(Exception ex){                return "";            }    }           public static String getSoundexF(String n){          CDGSoundex instance = new CDGSoundex();            return instance.soundexF(n);      }}
/
